eliminated <- subset(ab_2013, ab_2013$ytotcor > (Q[1] - 1.5*iqr) & ab_2013$ytotcor < (Q[2]+1.5*iqr))
#eliminated
a <- eliminated$ytotcor
b <- eliminated$comuna
c <- eliminated$e6a
d <- eliminated$e1 #alfabetismo
e <- eliminated$r1b_p_cod #etnia
f <- eliminated$sexo
anio <- 2013
#variable_in<-"ytotcor"
}
if(xx==2015) {
# dataset_15 <- readRDS("casen_2015_c.rds")
ab_2015 <- dataset_15[!is.na(dataset_15$ytotcor),]
Q <- quantile(ab_2015$ytotcor, probs=c(.25, .75), na.rm = FALSE)
iqr <- IQR(ab_2015$ytotcor)
eliminated <- subset(ab_2015, ab_2015$ytotcor > (Q[1] - 1.5*iqr) & ab_2015$ytotcor < (Q[2]+1.5*iqr))
#eliminated
a <- eliminated$ytotcor
b <- eliminated$comuna
c <- eliminated$e6a
d <- eliminated$e1 #alfabetismo
e <- eliminated$r1aesp_cod #etnia
f <- eliminated$sexo
anio <- 2015
#variable_in<-"ytotcor"
}
if(xx==2017) {
# dataset_17 <- readRDS("casen_2017_c.rds")
ab_2017 <- dataset_17[!is.na(dataset_17$ytotcor),]
Q <- quantile(ab_2017$ytotcor, probs=c(.25, .75), na.rm = FALSE)
iqr <- IQR(ab_2017$ytotcor)
eliminated <- subset(ab_2017, ab_2017$ytotcor > (Q[1] - 1.5*iqr) & ab_2017$ytotcor < (Q[2]+1.5*iqr))
#eliminated
a <- eliminated$ytotcor
b <- eliminated$comuna
c <- eliminated$e6a
d <- eliminated$e1 #alfabetismo
e <- eliminated$r1a_cod #etnia
f <- eliminated$sexo
anio <- 2017
# variable_in<-"ytotcor"
}
promedios_grupales <-aggregate(a, by=list(b, c, d, e,f), FUN = mean , na.rm = TRUE)
promedios_grupales_sd <-aggregate(a, by=list(b, c, d, e,f), FUN = sd , na.rm = TRUE)
promedios_grupales_gini <-aggregate(a, by=list(b, c, d, e,f), FUN = gini , na.rm = TRUE)
promedios_grupales$sd = promedios_grupales_sd$sd.a
promedios_grupales$gini = promedios_grupales_gini$gini.a
d<-promedios_grupales
d$Año <- anio
# head(d,5)
names(d)[1] <- "Comuna"
names(d)[2] <- "e6a"
names(d)[3] <- "Alfabetismo"
names(d)[4] <- "Etnia"
names(d)[5] <- "Sexo"
names(d)[6] <- "Promedio del Ingreso"
names(d)[7] <- "Desviación standard"
names(d)[8] <- "Gini"
names(d)[9] <- "Año"
# head(d,3)
codigos_comunales <- readRDS(file = comunales)
names(codigos_comunales)[1] <- "Código"
names(codigos_comunales)[2] <- "Comuna"
# codigos_comunales
df_2006 = merge( x = d, y = codigos_comunales, by = "Comuna", all.x = TRUE)
df <-df_2006[!(df_2006$Promedio == 0),]
head(df,5)
variable_in<-"ytotcor"
# ingreso_rds <- paste("e6a_",variable_in,"_",anio,"pruebas.rds", sep="")
# saveRDS(df,ingreso_rds)
# print(df)
return(df)
}
for (n in 1:4){
funcion1(n)
}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(markdown)
library(shiny)
library(shinythemes)
library(tidyverse)
library(magrittr)
library(lubridate)
library(plotly)
library(xts)
library(dygraphs)
library(kableExtra)
library(knitr)
library("readxl")
library(rsconnect)
library(dplyr)
library(summarytools)
library(epiDisplay)
#library(leaflet)
library(haven)
library(epiDisplay)
library("readxl")
library(hrbrthemes)
library(viridis)
library(viridisLite)
library(writexl)
library(plyr)
library(kableExtra)
library(knitr)
library(DescTools)
library(foreign)
# https://www.datacamp.com/community/tutorials/contingency-tables-r
oldw <- getOption("warn")
options(warn = -1)
# Como humanos, preferimos trabajar con etiquetas que con códigos.
dataset2006 <- readRDS("../../archivos_grandes/casen_2006_c.rds")
dataset2006  <- as_factor(dataset2006, only_labelled = TRUE)
dataset2009  <- readRDS("../../archivos_grandes/casen_2009_c.rds")
dataset2009  <- as_factor(dataset2009, only_labelled = TRUE)
dataset2011  <- readRDS("../../archivos_grandes/casen_2011_c.rds")
dataset2011  <- as_factor(dataset2011, only_labelled = TRUE)
dataset2013  <- readRDS("../../archivos_grandes/casen_2013_c.rds")
dataset2013  <- as_factor(dataset2013, only_labelled = TRUE)
dataset2015 <- readRDS("../../archivos_grandes/casen_2015_c.rds")
dataset2015  <- as_factor(dataset2015, only_labelled = TRUE)
dataset2017  <- readRDS("../../archivos_grandes/casen_2017_c.rds")
dataset2017  <- as_factor(dataset2017, only_labelled = TRUE)
dataset2020 <- read.spss("../../archivos_grandes/casen_2020.sav", to.data.frame=TRUE)
casen2006 <- readRDS("C:/Users/chris/OneDrive/Documentos/archivos_grandes/casen_2006_c.rds")
casen2006 <- mutate_if(casen2006, is.factor, as.character)
#suppressWarnings(library(RODBC))
library(ggplot2)
library(ggpubr)
library(markdown)
library(shiny)
library(shinythemes)
library(tidyverse)
library(magrittr)
library(lubridate)
library(plotly)
library(xts)
library(dygraphs)
library(kableExtra)
library(knitr)
library("readxl")
library(rsconnect)
library(dplyr)
library(summarytools)
library(epiDisplay)
#library(leaflet)
library(haven)
library(epiDisplay)
library("readxl")
library(expss)
library(hrbrthemes)
library(viridis)
library(viridisLite)
library(DescTools)
library(roperators)
library(shinycssloaders)
library(writexl)
library(labelled)
library(tidyverse)
library(haven)
library(readr)
library(sjmisc)
library(WriteXLS)
library(ineq)
library(readstata13)
library(reldist)
library(foreign)
library(DT)
casen2006 <- readRDS("C:/Users/chris/OneDrive/Documentos/archivos_grandes/casen_2006_c.rds")
casen2006 <- mutate_if(casen2006, is.factor, as.character)
casen2009 <- readRDS("C:/Users/chris/OneDrive/Documentos/archivos_grandes/casen_2009_c.rds")
casen2009 <- mutate_if(casen2009, is.factor, as.character)
casen2011 <- readRDS("C:/Users/chris/OneDrive/Documentos/archivos_grandes/casen_2011_c.rds")
casen2011 <- mutate_if(casen2011, is.factor, as.character)
casen2013 <- readRDS("C:/Users/chris/OneDrive/Documentos/archivos_grandes/casen_2013_c.rds")
casen2013 <- mutate_if(casen2013, is.factor, as.character)
casen2015 <- readRDS("C:/Users/chris/OneDrive/Documentos/archivos_grandes/casen_2015_c.rds")
casen2015 <- mutate_if(casen2015, is.factor, as.character)
casen2017 <- readRDS("C:/Users/chris/OneDrive/Documentos/archivos_grandes/casen_2017_c.rds")
casen2017 <- mutate_if(casen2017, is.factor, as.character)
#casen2020 <- read.spss(file="C:/Users/chris/OneDrive/Documentos/archivos_grandes/casen_2020.sav", to.data.frame=TRUE)
#saveRDS(casen2020,"casen2020.rds")
casen2020 <- readRDS("casen2020.rds")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(markdown)
library(shiny)
library(shinythemes)
library(tidyverse)
library(magrittr)
library(lubridate)
library(plotly)
library(xts)
library(dygraphs)
library(kableExtra)
library(knitr)
library("readxl")
library(rsconnect)
library(dplyr)
library(summarytools)
library(epiDisplay)
#library(leaflet)
library(haven)
library(epiDisplay)
library("readxl")
library(hrbrthemes)
library(viridis)
library(viridisLite)
library(writexl)
library(plyr)
library(kableExtra)
library(knitr)
library(DescTools)
library(foreign)
# https://www.datacamp.com/community/tutorials/contingency-tables-r
oldw <- getOption("warn")
options(warn = -1)
# Como humanos, preferimos trabajar con etiquetas que con códigos.
dataset2006 <- readRDS("../../archivos_grandes/casen_2006_c.rds")
dataset2006  <- as_factor(dataset2006, only_labelled = TRUE)
dataset2009  <- readRDS("../../archivos_grandes/casen_2009_c.rds")
dataset2009  <- as_factor(dataset2009, only_labelled = TRUE)
dataset2011  <- readRDS("../../archivos_grandes/casen_2011_c.rds")
dataset2011  <- as_factor(dataset2011, only_labelled = TRUE)
dataset2013  <- readRDS("../../archivos_grandes/casen_2013_c.rds")
dataset2013  <- as_factor(dataset2013, only_labelled = TRUE)
dataset2015 <- readRDS("../../archivos_grandes/casen_2015_c.rds")
dataset2015  <- as_factor(dataset2015, only_labelled = TRUE)
dataset2017  <- readRDS("../../archivos_grandes/casen_2017_c.rds")
dataset2017  <- as_factor(dataset2017, only_labelled = TRUE)
dataset2020 <- read.spss("../../archivos_grandes/casen_2020.sav", to.data.frame=TRUE)
ab <- dataset2006
b <- ab$COMUNA
x <- ab$E1
c <- ab$CORTE
d <- ab$T4
e <- ab$SEXO
cross_tab =  xtabs(ab$EXPC ~  unlist(b)  + unlist(x) + unlist(c)  + unlist(d) + unlist(e),aggregate(ab$EXPC ~   unlist(b)  + unlist(x) + unlist(c) + unlist(d) + unlist(e) ,ab,mean))
tabla <- as.data.frame(cross_tab)
d <-tabla[!(tabla$Freq == 0),]
d$anio <- "2006"
names(d)[1] <- "comuna"
names(d)[2] <- "Alfabetismo"
names(d)[3] <- "Pobreza"
names(d)[4] <- "Etnia"
names(d)[5] <- "Sexo"
names(d)[6] <- "Frecuencia"
names(d)[7] <- "Año"
codigos_comunales <- readRDS(file = "../../archivos_grandes/codigos_comunales_2006.rds")
names(codigos_comunales)[1] <- "código"
names(codigos_comunales)[2] <- "comuna"
df_2006 = merge( x = d, y = codigos_comunales, by = "comuna", all.x = TRUE)
datatable(df_2006, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='copy'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(markdown)
library(shiny)
library(shinythemes)
library(tidyverse)
library(magrittr)
library(lubridate)
library(plotly)
library(xts)
library(dygraphs)
library(kableExtra)
library(knitr)
library("readxl")
library(rsconnect)
library(dplyr)
library(summarytools)
library(epiDisplay)
#library(leaflet)
library(haven)
library(epiDisplay)
library("readxl")
library(hrbrthemes)
library(viridis)
library(viridisLite)
library(writexl)
library(plyr)
library(kableExtra)
library(knitr)
library(DescTools)
library(foreign)
library(DT)
# https://www.datacamp.com/community/tutorials/contingency-tables-r
oldw <- getOption("warn")
options(warn = -1)
ab <- dataset2006
b <- ab$COMUNA
x <- ab$E1
c <- ab$CORTE
d <- ab$T4
e <- ab$SEXO
cross_tab =  xtabs(ab$EXPC ~  unlist(b)  + unlist(x) + unlist(c)  + unlist(d) + unlist(e),aggregate(ab$EXPC ~   unlist(b)  + unlist(x) + unlist(c) + unlist(d) + unlist(e) ,ab,mean))
tabla <- as.data.frame(cross_tab)
d <-tabla[!(tabla$Freq == 0),]
d$anio <- "2006"
names(d)[1] <- "comuna"
names(d)[2] <- "Alfabetismo"
names(d)[3] <- "Pobreza"
names(d)[4] <- "Etnia"
names(d)[5] <- "Sexo"
names(d)[6] <- "Frecuencia"
names(d)[7] <- "Año"
codigos_comunales <- readRDS(file = "../../archivos_grandes/codigos_comunales_2006.rds")
names(codigos_comunales)[1] <- "código"
names(codigos_comunales)[2] <- "comuna"
df_2006 = merge( x = d, y = codigos_comunales, by = "comuna", all.x = TRUE)
datatable(df_2006, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='copy'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
ab <- dataset2009
b <- ab$COMUNA
x <- ab$E1
c <- ab$CORTE
d <- ab$T5
e <- ab$SEXO
cross_tab =  xtabs(ab$EXPC ~  unlist(b)  + unlist(x) + unlist(c)  + unlist(d) + unlist(e),aggregate(ab$EXPC ~   unlist(b) + unlist(x)  + unlist(c) + unlist(d) + unlist(e) ,ab,mean))
tabla <- as.data.frame(cross_tab)
d <-tabla[!(tabla$Freq == 0),]
d$anio <- "2009"
names(d)[1] <- "comuna"
names(d)[2] <- "Alfabetismo"
names(d)[3] <- "Pobreza"
names(d)[4] <- "Etnia"
names(d)[5] <- "Sexo"
names(d)[6] <- "Frecuencia"
names(d)[7] <- "Año"
codigos_comunales <- readRDS(file = "../../archivos_grandes/codigos_comunales_2009.rds")
names(codigos_comunales)[1] <- "código"
names(codigos_comunales)[2] <- "comuna"
df_2009 = merge( x = d, y = codigos_comunales, by = "comuna", all.x = TRUE)
head(df_2009,10)
#suppressWarnings(library(RODBC))
library(ggplot2)
library(ggpubr)
library(markdown)
library(shiny)
library(shinythemes)
library(tidyverse)
library(magrittr)
library(lubridate)
library(plotly)
library(xts)
library(dygraphs)
library(kableExtra)
library(knitr)
library("readxl")
library(rsconnect)
library(dplyr)
library(summarytools)
library(epiDisplay)
#library(leaflet)
library(haven)
library(epiDisplay)
library("readxl")
library(expss)
library(hrbrthemes)
library(viridis)
library(viridisLite)
library(DescTools)
library(roperators)
library(shinycssloaders)
library(writexl)
library(labelled)
library(tidyverse)
library(haven)
library(readr)
library(sjmisc)
library(WriteXLS)
library(ineq)
library(readstata13)
library(reldist)
library(foreign)
library(DT)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(markdown)
library(shiny)
library(shinythemes)
library(tidyverse)
library(magrittr)
library(lubridate)
library(plotly)
library(xts)
library(dygraphs)
library(kableExtra)
library(knitr)
library("readxl")
library(rsconnect)
library(dplyr)
library(summarytools)
library(epiDisplay)
#library(leaflet)
library(haven)
library(epiDisplay)
library("readxl")
library(hrbrthemes)
library(viridis)
library(viridisLite)
library(writexl)
library(plyr)
library(kableExtra)
library(knitr)
library(DescTools)
library(foreign)
library(DT)
# https://www.datacamp.com/community/tutorials/contingency-tables-r
oldw <- getOption("warn")
options(warn = -1)
ab <- dataset2006
b <- ab$COMUNA
x <- ab$E1
c <- ab$CORTE
d <- ab$T4
e <- ab$SEXO
cross_tab =  xtabs(ab$EXPC ~  unlist(b)  + unlist(x) + unlist(c)  + unlist(d) + unlist(e),aggregate(ab$EXPC ~   unlist(b)  + unlist(x) + unlist(c) + unlist(d) + unlist(e) ,ab,mean))
tabla <- as.data.frame(cross_tab)
d <-tabla[!(tabla$Freq == 0),]
d$anio <- "2006"
names(d)[1] <- "comuna"
names(d)[2] <- "Alfabetismo"
names(d)[3] <- "Pobreza"
names(d)[4] <- "Etnia"
names(d)[5] <- "Sexo"
names(d)[6] <- "Frecuencia"
names(d)[7] <- "Año"
codigos_comunales <- readRDS(file = "../../archivos_grandes/codigos_comunales_2006.rds")
names(codigos_comunales)[1] <- "código"
names(codigos_comunales)[2] <- "comuna"
df_2006 = merge( x = d, y = codigos_comunales, by = "comuna", all.x = TRUE)
datatable(df_2006, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='copy'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
# Como humanos, preferimos trabajar con etiquetas que con códigos.
dataset2006 <- readRDS("../../archivos_grandes/casen_2006_c.rds")
dataset2006  <- as_factor(dataset2006, only_labelled = TRUE)
dataset2009  <- readRDS("../../archivos_grandes/casen_2009_c.rds")
dataset2009  <- as_factor(dataset2009, only_labelled = TRUE)
dataset2011  <- readRDS("../../archivos_grandes/casen_2011_c.rds")
dataset2011  <- as_factor(dataset2011, only_labelled = TRUE)
dataset2013  <- readRDS("../../archivos_grandes/casen_2013_c.rds")
dataset2013  <- as_factor(dataset2013, only_labelled = TRUE)
dataset2015 <- readRDS("../../archivos_grandes/casen_2015_c.rds")
dataset2015  <- as_factor(dataset2015, only_labelled = TRUE)
dataset2017  <- readRDS("../../archivos_grandes/casen_2017_c.rds")
dataset2017  <- as_factor(dataset2017, only_labelled = TRUE)
dataset2020 <- read.spss("../../archivos_grandes/casen_2020.sav", to.data.frame=TRUE)
ab <- dataset2006
b <- ab$COMUNA
x <- ab$E1
c <- ab$CORTE
d <- ab$T4
e <- ab$SEXO
cross_tab =  xtabs(ab$EXPC ~  unlist(b)  + unlist(x) + unlist(c)  + unlist(d) + unlist(e),aggregate(ab$EXPC ~   unlist(b)  + unlist(x) + unlist(c) + unlist(d) + unlist(e) ,ab,mean))
tabla <- as.data.frame(cross_tab)
d <-tabla[!(tabla$Freq == 0),]
d$anio <- "2006"
names(d)[1] <- "comuna"
names(d)[2] <- "Alfabetismo"
names(d)[3] <- "Pobreza"
names(d)[4] <- "Etnia"
names(d)[5] <- "Sexo"
names(d)[6] <- "Frecuencia"
names(d)[7] <- "Año"
codigos_comunales <- readRDS(file = "../../archivos_grandes/codigos_comunales_2006.rds")
names(codigos_comunales)[1] <- "código"
names(codigos_comunales)[2] <- "comuna"
df_2006 = merge( x = d, y = codigos_comunales, by = "comuna", all.x = TRUE)
datatable(df_2006, extensions = 'Buttons', escape = FALSE, rownames = FALSE,
options = list(dom = 'Bfrtip',
buttons = list('colvis', list(extend = 'collection',
buttons = list(
list(extend='copy'),
list(extend='excel',
filename = 'hitStats'),
list(extend='pdf',
filename= 'hitStats')),
text = 'Download')), scrollX = TRUE))
unique( df_2006$Alfabetismo)
unique( df_2015$Alfabetismo)
unique( dataset2015$Alfabetismo)
unique( dataset2015$e1)
